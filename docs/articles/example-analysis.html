<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="animation">
<title>Example data analysis • animation</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example data analysis">
<meta property="og:description" content="animation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">animation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example-analysis.html">Example data analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yihui/animation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example data analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yihui/animation/blob/HEAD/vignettes/example-analysis.Rmd" class="external-link"><code>vignettes/example-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>example-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="question">Question<a class="anchor" aria-label="anchor" href="#question"></a>
</h3>
<p>How has global temperature changed from 1880 to present? Are there
temporal and geographic differences associated with temperature change?
Is temperature change approximately linear in recent years?</p>
<blockquote>
<p>ℹ️ Brownian motion</p>
<p>Recall that the rate of Brownian motion is proportional to the
temperature of a material. The warmer a substance is, the faster its
particles move.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First function call from animation package</span></span>
<span><span class="fu"><a href="../reference/ani.options.html">ani.options</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">0.01</span>, nmax <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/brownian.motion.html">brownian.motion</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, </span>
<span>                cex <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                col <span class="op">=</span> <span class="st">"green"</span>, </span>
<span>                bg <span class="op">=</span> <span class="st">"#0072B2"</span>, </span>
<span>                main <span class="op">=</span> <span class="st">"Demo: Brownian Motion"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example-analysis_files/figure-html/unnamed-chunk-2.gif" width="576"></p>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>Global surface temperature observations for 1880 to 2022 came from
NASA GISS Surface Temperature Analysis (GISTEMP v4). The temperature
anomalies (i.e. deviations from the mean) are relative to 1951-1980
average temperatures. The data were downloaded via <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-07-11" class="external-link">TidyTuesday
(2023-07-11)</a>. The data dictionary is available <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-07-11/readme.md#data-dictionary" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List required files to download from TidyTuesday</span></span>
<span><span class="va">rds_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"global_temps.rds"</span>, <span class="st">"nh_temps.rds"</span>,<span class="st">"sh_temps.rds"</span>,<span class="st">"zonann_temps.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if any of these files don't exist</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="va">rds_files</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># if data directory doesn't exist, make it</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span>
<span></span>
<span><span class="co"># if files are missing, download the data</span></span>
<span><span class="va">tuesdata</span> <span class="op">&lt;-</span> <span class="fu">tidytuesdayR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytuesdayR/man/tt_load.html" class="external-link">tt_load</a></span><span class="op">(</span><span class="st">'2023-07-11'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">global_temps</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">global_temps</span></span>
<span><span class="va">nh_temps</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">nh_temps</span></span>
<span><span class="va">sh_temps</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">sh_temps</span></span>
<span><span class="va">zonann_temps</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">zonann_temps</span></span>
<span></span>
<span><span class="co"># save the data object as a .csv file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">global_temps</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"global_temps.rds"</span><span class="op">)</span>, version <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">nh_temps</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"nh_temps.rds"</span><span class="op">)</span>, version <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">sh_temps</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"sh_temps.rds"</span><span class="op">)</span>, version <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">zonann_temps</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"zonann_temps.rds"</span><span class="op">)</span>, version <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">global_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"global_temps.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nh_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"nh_temps.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sh_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"sh_temps.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">zonann_temps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"zonann_temps.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Begin wrangling data</span></span>
<span><span class="va">zonann_temps_longer</span> <span class="op">&lt;-</span> <span class="va">zonann_temps</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span><span class="st">"Global"</span> <span class="op">=</span> <span class="st">"Glob"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span><span class="st">"Global"</span><span class="op">:</span><span class="st">"90S-64S"</span>,</span>
<span>               names_to<span class="op">=</span><span class="st">"lat_band"</span>,</span>
<span>               values_to<span class="op">=</span><span class="st">"ano"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate ~smoothed difference in temperature over the entire record</span></span>
<span><span class="va">my_diff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">end</span> <span class="op">-</span> <span class="va">beg</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">temp_diffs</span> <span class="op">&lt;-</span> <span class="va">zonann_temps</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">map</span><span class="op">(</span>.f <span class="op">=</span> <span class="va">my_diff</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="global-temperature-change">Global temperature change<a class="anchor" aria-label="anchor" href="#global-temperature-change"></a>
</h3>
<p>Global temperature has increased by more than 1°C between 1880 and
2022. Temperature has increased in a non-linear way, with the fastest
rates observed in recent years.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot data</span></span>
<span><span class="va">zonann_temps_longer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lat_band</span><span class="op">==</span><span class="st">"Global"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">ano</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Global temperature anomaly (°C)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Global temperature anomaly from 1880 to 2022"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Global temperature has increased ~1.1°C since 1880"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Data source: NASA GISS Surface Temperature Analysis (GISTEMP v4)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<div class="figure">
<img src="example-analysis_files/figure-html/unnamed-chunk-5-1.png" alt="Figure 1. Mean global temperature anomalies from 1880 to 2022, relative to 1951-1980 means." width="672"><p class="caption">
Figure 1. Mean global temperature anomalies from 1880 to 2022, relative
to 1951-1980 means.
</p>
</div>
</div>
<div class="section level3">
<h3 id="temperature-change-by-latitudinal-band">Temperature change by latitudinal band<a class="anchor" aria-label="anchor" href="#temperature-change-by-latitudinal-band"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zonann_temps_longer</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lat_band</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"24N-90N"</span>,<span class="st">"24S-24N"</span>,<span class="st">"90S-24S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">ano</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rect</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin<span class="op">=</span><span class="fl">1951</span>, xmax<span class="op">=</span><span class="fl">1980</span>, ymin<span class="op">=</span><span class="op">-</span><span class="fl">0.5</span>, ymax<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">lat_band</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature anomaly (°C)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Temperature change by latitudinal band"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Temperate and polar regions in the northern hemisphere (24-90N) experienced \nhigher variability and larger overall temperature change."</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Data source: NASA GISS Surface Temperature Analysis (GISTEMP v4)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="example-analysis_files/figure-html/unnamed-chunk-6-1.png" alt="Figure 2. Temperature anomalies from 1880 to 2022 in three latitudinal bands. Anomalies are relative to average temperatures from 1951-1980 (shaded in periwinkle). The overall magnitude and rate of temperature increase varies across latitudes." width="672"><p class="caption">
Figure 2. Temperature anomalies from 1880 to 2022 in three latitudinal
bands. Anomalies are relative to average temperatures from 1951-1980
(shaded in periwinkle). The overall magnitude and rate of temperature
increase varies across latitudes.
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span><span class="co"># Calculate average anomaly for each column (i.e. different areas/latitude bands) in recent past (1970-2022)</span></span>
<span><span class="va">mean_anos_by_lat_band</span> <span class="op">&lt;-</span> <span class="va">zonann_temps</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span><span class="op">&gt;=</span><span class="fl">1970</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">map_dbl</span><span class="op">(</span>.f<span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p>Based on Figures 1 and 2, it appears that temperature has increased
in a roughly linear fashion from ~1970s to present, and this period
accounts for nearly half of the observed temperature change over the
entire 142 year record! We also notice that the recent temperature
increase has been larger in the more northern latitudes (24-90N:
0.585°C) compared to the mid-latitudes (24S-24N: 0.400°C) or the
southern latitudes (24-90S: 0.355°C).</p>
</div>
<div class="section level3">
<h3 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h3>
<p>Given the approximately linear relationship between global
temperature change and recent time (1970 to 2022), let’s use a linear
model to estimate how fast global temperature has increased.</p>
<blockquote>
<p>ℹ️ Least squares</p>
<p>Recall that linear regression minimizes a least squares loss function
to estimate the slope and intercept parameters.</p>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Second function call from animation package</span></span>
<span><span class="co"># Demo: least squares </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ani.options.html">ani.options</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">0.3</span>, nmax <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## default animation: with slope changing</span></span>
<span><span class="fu"><a href="../reference/least.squares.html">least.squares</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Demo: Fit slope"</span><span class="op">)</span></span></code></pre></div>
<img src="example-analysis_files/figure-html/unnamed-chunk-7.gif" alt="Demonstration of least squares minimization to fit the slope in linear regression." width="576"><p class="caption">
Demonstration of least squares minimization to fit the slope in linear
regression.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Third function call from animation package</span></span>
<span><span class="co"># Demo: least squares </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ani.options.html">ani.options</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">0.3</span>, nmax <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## intercept changing</span></span>
<span><span class="fu"><a href="../reference/least.squares.html">least.squares</a></span><span class="op">(</span>ani.type <span class="op">=</span> <span class="st">"intercept"</span>,</span>
<span>              main <span class="op">=</span> <span class="st">"Demo: Fit intercept"</span><span class="op">)</span></span></code></pre></div>
<img src="example-analysis_files/figure-html/unnamed-chunk-8.gif" alt="Demonstration of least squares minimization to fit the intercept in linear regression." width="576"><p class="caption">
Demonstration of least squares minimization to fit the intercept in
linear regression.
</p>
</main>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_temp_df</span> <span class="op">&lt;-</span> <span class="va">zonann_temps_longer</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lat_band</span><span class="op">==</span><span class="st">"Global"</span>,</span>
<span>         <span class="va">Year</span><span class="op">&gt;=</span><span class="fl">1970</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ano</span> <span class="op">~</span> <span class="va">Year</span>, data <span class="op">=</span> <span class="va">global_temp_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#summary(temp.lm)</span></span>
<span><span class="co">#plot(temp.lm)</span></span>
<span></span>
<span><span class="va">global_temp_df</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html" class="external-link">predict.lm</a></span><span class="op">(</span><span class="va">temp.lm</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1970</span>, <span class="fl">2022</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_temp_df_plotting</span> <span class="op">&lt;-</span> <span class="va">global_temp_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">ano</span><span class="op">:</span><span class="va">Predicted</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"data_type"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>data_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">data_type</span> <span class="op">==</span> <span class="st">"ano"</span> <span class="op">~</span> <span class="st">"Observed"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">data_type</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">lat_band</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="va">global_temp_df_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Year</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">data_type</span>, color <span class="op">=</span> <span class="va">data_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature anomaly (°C)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Global temperature change from 1970 to 2022"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"In recent years, global temperature has increased an average of ~0.02 °C per year."</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Data source: NASA GISS Surface Temperature Analysis (GISTEMP v4)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Data type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="example-analysis_files/figure-html/unnamed-chunk-10-1.png" alt="Figure 3. Observed and predicted global temperature anomalies from 1970 to 2022, relative to 1951-1980 means. Temperature has increased in an approximately linear way over the past 50 years." width="672"><p class="caption">
Figure 3. Observed and predicted global temperature anomalies from 1970
to 2022, relative to 1951-1980 means. Temperature has increased in an
approximately linear way over the past 50 years.
</p>
</div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>In summary, we see that global temperature has increased more than
1°C from 1880 to 2022. In recent years (1970-present), the increase has
been approximately linear, changing at a rate of ~0.02°C per year!
However, given the non-linear trends observed over the whole record, we
might reasonably expect that warming rates will continue to accelerate
in the near future.</p>
</div>
<div class="section level3">
<h3 id="functions-used">Functions used<a class="anchor" aria-label="anchor" href="#functions-used"></a>
</h3>
<p>dplyr: rename, pivot_longer, filter, mutate, case_when, select purrr:
map, map_dbl ggplot2: geom_smooth, geom_line, geom_point, geom_rect
animation: least.squares, brownian.motion</p>
</div>
<div class="section level3">
<h3 id="todo">TODO:<a class="anchor" aria-label="anchor" href="#todo"></a>
</h3>
<p>add purrr functions, 1 more dplyr/stringr functions, add explanatory
text, add code-folding?</p>
</div>
  <aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside><footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yihui Xie.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</body>
</html>
